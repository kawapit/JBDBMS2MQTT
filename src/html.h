#pragma once

#include <Arduino.h>  // PROGMEM

static const char bms[] PROGMEM = R"rawliteral(%header% <figure class=text-center><h2 id=deviceAliasID></h2></figure><div class="row gx-0 mb-1"style="padding-bottom: 0rem;padding-top: 0px; display: none;"id=alertID><div style="text-align: center;"id=alertID role=alert><i id=alertIconID></i><span id=alertMessageID></span></div></div><div class="row gx-0 mb-2"><div class=col id=clickSoCID><div class=progress style=height:1.8rem;><div class="progress-bar dF"style="width:0%; height:1.8rem;"aria-valuemax=100 aria-valuemin=0 aria-valuenow=0 id=SoCID role=progressbar></div></div></div></div><div class="row gx-0 mb-2"style="display: none;"id=cellRowID><div class="col card chart-container"style="position: relative; height:15vh; width:80vw"><canvas id=chartID></canvas></div></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-2"><div class=col>Device:</div><div class="col dF"><span id=deviceNameID></span></div></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-2"><div class=col>Package:</div><div class="col dF"><span id=voltageID></span><span id=currentID></span><span id=powerID></span></div></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-2"><div class=col>remaining Capacity:</div><div class="col dF"><span id=remainingID></span><span id=remaining2ID></span></div></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-2"><div class=col>Charge Cycles:</div><div class="col dF"><span id=cyclesID></span></div></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-2"><div class=col>Temperatures:</div><div class="col dF"><span id=temp1ID></span><span id=temp2ID></span><span id=temp3ID></span></div></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-2"><div class=col>Cell Difference:</div><div class="col dF"><span id=cellDiffID></span></div></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-2"><div class=col>Cells â†‘/â†“:</div><div class="col dF"><span id=cellHID></span><span id=cellLID></span></div></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-2"><div class=col>BMS State:</div><div class=col><span id=stateID></span><button class="btn btn-warning"style="padding: 0px;font-size: 12px;"id=wakeBmsID type=button>wake BMS</button></div></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-2"><div class=col>charge MOS:</div><div class="col dF"><div class="form-check form-switch"><input class=form-check-input id=chargeStateID role=switch type=checkbox></div></div></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-2"><div class=col>discharge MOS:</div><div class="col dF"><div class="form-check form-switch"><input class=form-check-input id=dischargeStateID role=switch type=checkbox></div></div></div><div class="row gx-0 mb-1 bg-light bg-opacity-50 px-2"><div class=col>Balance:</div><div class="col dF"><div class="form-check form-switch"><input class=form-check-input id=balanceStateID role=switch type=checkbox></div></div></div><div class="row gx-0 mb-2 bg-light bg-opacity-50 px-2"><div class=col>Relais Output:</div><div class="col dF"><div class="form-check form-switch"><input class=form-check-input disabled id=relayStateID role=switch type=checkbox></div></div></div><div class="d-grid gap-2"><a class="btn btn-primary btn-block"href=/life role=button>Life</a><a class="btn btn-primary btn-block"href=/settings role=button>Settings</a></div><script>var onMessage=(a=>{let k=0,l=`none`,m=`disabled`,i=`wakeBmsID`,j=``,d=`stateID`,e=`V / `,g=`V `,h=`Â°C / `,f=Math.round;var b=JSON.parse(a.data);document.getElementById(`deviceNameID`).innerHTML=b.BAT.name;document.getElementById(`deviceAliasID`).innerHTML=`ESP32-`+ b.BAT.alias;document.getElementById(d).innerHTML=b.BAT.state;document.getElementById(`voltageID`).innerHTML=b.BAT.voltage+ e;document.getElementById(`currentID`).innerHTML=b.BAT.current+ `A / `;document.getElementById(`powerID`).innerHTML=f(b.BAT.power)+ `W  `;document.getElementById(`SoCID`).innerHTML=b.BAT.soc+ `%%`;$(`#SoCID`).width(b.BAT.soc+ `%`).attr(`aria-valuenow`,b.BAT.soc);document.getElementById(`remainingID`).innerHTML=b.BAT.soc_Ah+ `Ah / `;document.getElementById(`remaining2ID`).innerHTML=f(b.BAT.soc_Ah*b.BAT.voltage)/1000+ `kWh `;document.getElementById(`cellHID`).innerHTML=b.BAT.imax+ `â†‘ `+ b.BAT.max+ e;document.getElementById(`cellLID`).innerHTML=b.BAT.imin+ `â†“ `+ b.BAT.min+ g;document.getElementById(`cyclesID`).innerHTML=b.BAT.cycles+ ` `;document.getElementById(`temp1ID`).innerHTML=b.TEMP.temp1+ h;document.getElementById(`temp2ID`).innerHTML=b.TEMP.temp2+ h;document.getElementById(`temp3ID`).innerHTML=b.TEMP.temp3+ `Â°C `;document.getElementById(`cellDiffID`).innerHTML=b.BAT.diff+ g;document.getElementById(`chargeStateID`).checked=b.BAT.charge;document.getElementById(`dischargeStateID`).checked=b.BAT.discharge;document.getElementById(`balanceStateID`).checked=b.BAT.balance;document.getElementById(`relayStateID`).checked=b.REL.state;BarChart(b);Alert(b);if(b.BAT.state==`offline`){document.getElementById(d).style.color=`red`;document.getElementById(i).style.display=j;for(var c=k;c<dataFields.length;c++){dataFields[c].style.display=l}}else{document.getElementById(d).style.color=j;document.getElementById(i).style.display=l;for(var c=k;c<dataFields.length;c++){dataFields[c].style.display=j}};if(b.REL.manual){relayStateID.removeAttribute(m)}else{relayStateID.setAttribute(m,m)}});var CellState=(()=>{let b=`none`;var a=document.getElementById(`cellRowID`);if(a.style.display===b){a.style.display=``}else{a.style.display=b}});var DischargeSwitch=(()=>{let c=`dischargeStateID`;let a;if(document.getElementById(c).checked){a=`discharge_on`;websocket.send(a)}else{a=`discharge_off`;var b=confirm(`are you sure to disable the DISCHARGE MOS?! You maybe create your own personal blackout!`);if(b){websocket.send(a)}else{document.getElementById(c).checked=!0}}});var RelaySwitch=(()=>{let a;if(document.getElementById(`relayStateID`).checked){a=`relay_on`}else{a=`relay_off`};websocket.send(a)});var BalanceSwitch=(()=>{let a;if(document.getElementById(`balanceStateID`).checked){a=`balance_on`}else{a=`balance_off`};websocket.send(a)});var initButton=(()=>{let a=`click`;document.getElementById(`chargeStateID`).addEventListener(a,ChargeSwitch);document.getElementById(`dischargeStateID`).addEventListener(a,DischargeSwitch);document.getElementById(`balanceStateID`).addEventListener(a,BalanceSwitch);document.getElementById(`relayStateID`).addEventListener(a,RelaySwitch);document.getElementById(`wakeBmsID`).addEventListener(a,WakeBms);document.getElementById(`clickSoCID`).addEventListener(a,CellState)});var onLoad=(a=>{initWebSocket()});var BarChart=(a=>{let i=0,j=1,k=`DarkBlue`,l=`Cell Voltage`;var b=Object.values(a.CELLS);var c=[];var d=[];var e=[];var f=[];var g=i;var h=i;for(let l=i;l<b.length;l++){if(l%2==i){c.push(b[l]);e[g]=g+ j;if(g==a.BAT.imax- j){f[g]=k}else if(g==a.BAT.imin- j){f[g]=`LightSkyBlue`}else{f[g]=`#0a58ca`};if(g==a.BAT.imax- j){f[g]=k};g=g+ j}else{d.push(b[l]);if(b[l]==j){f[h]=`BlueViolet`};h=h+ j}};if(createBarChart==!0){createBarChart=!1;ctx=document.getElementById(`chartID`).getContext(`2d`);cellChart=new Chart(ctx,{type:`bar`,data:{labels:e,datasets:[{label:l,backgroundColor:f,borderColor:`rgb(13,110,253)`,data:c}]},options:{maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!1},label:{display:!1}},scales:{y:{min:a.BAT.vmin,max:a.BAT.vmax},x:{display:!0}}}})}else{cellChart.data.datasets.pop();cellChart.data.datasets.push({backgroundColor:f,borderColor:`rgb(10,88,202)`,labels:e,label:l,data:c});cellChart.update(`none`)}});var WakeBms=(()=>{let a;a=`wake_bms`;websocket.send(a)});var initWebSocket=(()=>{console.log(`trying to open a WebSocket connection...`);websocket=new WebSocket(gateway);websocket.onload=onLoad;websocket.onopen=onOpen;websocket.onclose=onClose;websocket.onerror=onError;websocket.onmessage=onMessage});var ChargeSwitch=(()=>{let a;if(document.getElementById(`chargeStateID`).checked){a=`charge_on`}else{a=`charge_off`};websocket.send(a)});var onOpen=(a=>{console.log(`Connection opened`);setInterval(checkWS,5000)});var refreshAlert=(()=>{let d=`alertID`,b=1,c=`alertIconID`;var a;if(alertListitem<alertListArr.length- b){a=alertListArr[alertListitem];alertListitem++}else{a=alertListArr[alertListitem];alertListitem=0};if(typeof a!==`undefined`){if(a[a.length- b]==`1`){document.getElementById(c).className=`bi bi-info-circle-fill`;document.getElementById(d).className=`row gx-0 mb-2 alert alert-info`}else if(a[a.length- b]==`2`){document.getElementById(c).className=`bi bi-exclamation-circle-fill`;document.getElementById(d).className=`row gx-0 mb-2 alert alert-warning`}else{document.getElementById(c).className=`bi bi-x-circle-fill`;document.getElementById(d).className=`row gx-0 mb-2 alert alert-danger`}};document.getElementById(`alertMessageID`).innerHTML=a});var Alert=(a=>{let e=0,f=`alertID`;alertListArr=[];if(a.ESP.vcc<2.8){alertListArr.push(`ESP Voltage to low`)};if(!a.BAT.failcodes.length==e){var b;var c=a.BAT.failcodes.split(`,`);for(var d in c){b=c[d];alertListArr.push(c[d])}};if(alertListArr.length==e){document.getElementById(f).style.display=`none`}else{document.getElementById(f).style.display=``};if(kickRefresh){refreshAlert();kickRefresh=!1}});var onError=(a=>{document.getElementById(`stateID`).innerHTML=`WS lost`;console.log(`Connection lost`)});var onClose=(a=>{document.getElementById(`stateID`).innerHTML=`WS closed`;console.log(`Connection closed`);setTimeout(initWebSocket,3000)});var checkWS=(()=>{if(websocket.readyState!==WebSocket.CLOSED){websocket.send(`ping`)}});$(document).ready((()=>{initWebSocket();initButton();setInterval(refreshAlert,5000)}));var gateway=`ws://${window.location.host}/ws`;var websocket;var ctx;var cellChart;var createBarChart=!0;var alertListArr=[];var alertListitem=0;var kickRefresh=!0;var dataFields=document.getElementsByClassName(`dF`)</script> %footer% <p hidden>)rawliteral";
#define bms_LENGTH 9821
static const char confirm_reset[] PROGMEM = R"rawliteral(%header% <figure class=text-center><h3>erase all data?</h3></figure><div class="d-grid gap-2"><a class="btn btn-danger"href=/reset role=button>yes</a><a class="btn btn-primary"href=/settings role=button>no</a></div> %footer% <p hidden>)rawliteral";
#define confirm_reset_LENGTH 235
static const char footer[] PROGMEM = R"rawliteral(<figure class=text-center>JbdBMS2MQTT <a id=swVersionId>%softwareVersion%</a> by <a href=https://github.com/kawapit/JbdBMS2MQTT target=_blank>YASH-IT</a><a href=http://creativecommons.org/licenses/by-nc-nd/4.0/ rel=license target=_blank><img alt="Creative Commons License"src=https://licensebuttons.net/l/by-nc-nd/4.0/80x15.png style=border-width:0></a></figure><div style="display: none;"id=update_alert><figure class=text-center><a id=fwdownload target=_blank>Download the latest version <b id=gitversion></b></a></figure></div><script>$(document).ready((()=>{let d=``,e=0,g=`m`,b=`.`,a=1,f=`e`,c=parseInt;$.getJSON(`https://api.github.com/repos/kawapit/JbdBMS2MQTT/releases/latest`,(()=>{})).done((h=>{console.log(`get data from github done success`);$(`#fwdownload`).attr(`href`,h.html_url);$(`#gitversion`).text(h.tag_name.substring(a));let j=h.tag_name.substring(a).split(b).map(a=>c(a));let k=`%swversion%`.split(b).map(a=>c(a));let l=d;for(i=e;i<j.length;i++){if(j[i]===k[i]){l+=f}else if(j[i]>k[i]){l+=g}else{l+=`l`}};if(!l.match(/[l|m]/g)){console.log(`Git-Version equal, nothing to do.`)}else if(l.split(f).join(d)[e]==g){console.log(`Git-Version higher, activate notification.`);document.getElementById(`update_alert`).style.display=d}else{console.log(`Git-Version lower, nothing to do.`)}})).fail((()=>{console.log(`error can not get version`)}))}))</script>)rawliteral";
#define footer_LENGTH 1371
static const char header[] PROGMEM = R"rawliteral(<!doctypehtml><html data-bs-theme=%theme% lang=en xml:lang=en><meta content=text/html;charset=UTF-8 http-equiv=content-type><meta content=width=device-width,initial-scale=1 name=viewport><link rel="shortcut icon"href=data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAHsSURBVDhPrZLLSxtRFMZHY9A2Wou0FB+oiZUWTaPEVo15qInBjamSqLFVk0rV0ke0saAmgg90o5v42NQHCmYkXehC/wbFuK//gG6yyiIki0Dg69zDEEgp46L+4HKHc8/3zTnnXg7/yf0b7O7tIZVK0XcikaBdCjKIx+MI8jzGxj+hWadHu9mC94NDlHAXZBAIrENTVw+O49LrlaYOfv8cJUnBnV9cYNjlJlGOPBfZMnnaZGrqBw6DQTH131AFLtcHEjDxQ0UBunvsMBhMWFhcoiQpyODj6Fj6rz6fH03NOmpL2/BGmEkLnZdXVGJ+YRFPnj5DKPSLxAzu5uYWkUgEXba3KHxchP39AyhVVVheXoFarYHZ0oHPX76iplYNj2cCptY29DsHRLlYQTKZxOnpGaLRKFRV1dAbjLAJhsUlZdBqX8PpfIeS0jKhCiW+e73gsmQkZpABIxaL4ff1NbXxzeNBVnYOFPmPUP3iJazWTuQ9UNCQJyYnKef4+IR0aQMGzx/Bbu/Fz+0dDA4Nw+0ewfTMLFZX1+imWIw9NEdvPzY2t0iTYeAT7r1Fb4TBaBIeUwfNRal6TiU7HH0UY2dt7WY0NulIk2HwN2y4FosV8tw8XIbDYjQTSYPw1RUC6xvU0mGQF6OZSBrcDfAHIwsaPAvZdQgAAAAASUVORK5CYII=><link crossorigin href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css integrity=sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9 rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css rel=stylesheet><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script><script crossorigin integrity=sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js></script><script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js "></script><title>%deviceName%</title><body><noscript><strong>We're sorry but it doesn't work properly without JavaScript enabled. Please enable it to continue.</strong></noscript><div class="container-sm col-sm-10 col-md-6 col-lg-4">)rawliteral";
#define header_LENGTH 1928
static const char life[] PROGMEM = R"rawliteral(<!doctypehtml><html data-bs-theme=%theme% lang=en xml:lang=en><meta content=text/html;charset=UTF-8 http-equiv=content-type><meta content=width=device-width,initial-scale=1 name=viewport><link href=favicon.ico rel=icon type=image/x-icon><link href=life.css rel=stylesheet><link rel="shortcut icon"href=data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAHsSURBVDhPrZLLSxtRFMZHY9A2Wou0FB+oiZUWTaPEVo15qInBjamSqLFVk0rV0ke0saAmgg90o5v42NQHCmYkXehC/wbFuK//gG6yyiIki0Dg69zDEEgp46L+4HKHc8/3zTnnXg7/yf0b7O7tIZVK0XcikaBdCjKIx+MI8jzGxj+hWadHu9mC94NDlHAXZBAIrENTVw+O49LrlaYOfv8cJUnBnV9cYNjlJlGOPBfZMnnaZGrqBw6DQTH131AFLtcHEjDxQ0UBunvsMBhMWFhcoiQpyODj6Fj6rz6fH03NOmpL2/BGmEkLnZdXVGJ+YRFPnj5DKPSLxAzu5uYWkUgEXba3KHxchP39AyhVVVheXoFarYHZ0oHPX76iplYNj2cCptY29DsHRLlYQTKZxOnpGaLRKFRV1dAbjLAJhsUlZdBqX8PpfIeS0jKhCiW+e73gsmQkZpABIxaL4ff1NbXxzeNBVnYOFPmPUP3iJazWTuQ9UNCQJyYnKef4+IR0aQMGzx/Bbu/Fz+0dDA4Nw+0ewfTMLFZX1+imWIw9NEdvPzY2t0iTYeAT7r1Fb4TBaBIeUwfNRal6TiU7HH0UY2dt7WY0NulIk2HwN2y4FosV8tw8XIbDYjQTSYPw1RUC6xvU0mGQF6OZSBrcDfAHIwsaPAvZdQgAAAAASUVORK5CYII=><link crossorigin href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css integrity=sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9 rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css rel=stylesheet><script crossorigin integrity=sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm src=https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js></script><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.4/raphael-min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/justgage/1.5.1/justgage.min.js></script><script src="https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.umd.min.js "></script><title>LiFePO4 Jbd%bmsAlias%</title><body><noscript><strong>We're sorry but it doesn't work properly without JavaScript enabled. Please enable it to continue.</strong></noscript><div class="container-sm col-sm-10 col-md-6 col-lg-8"><div class=topBar>LiFePO4 %bmsAlias%</div><div class="title size-3">voltage</div><div class="title size-3">current</div><div class="title size-2">ntc 1</div><div class=clear></div><div class="gauge size-3"id=voltageID></div><div class=h-split></div><div class="gauge size-3"id=currentID></div><div class=h-split></div><div class="gauge size-2"id=temp1ID></div><div class=clear></div><div class="title size-3">soc</div><div class="title size-3">cell diff</div><div class="title size-2">ntc 2</div><div class=clear></div><div class="gauge size-3"id=socID></div><div class=h-split></div><div class="gauge size-3"id=cellDiffID></div><div class=h-split></div><div class="gauge size-2"id=temp2ID></div><div class=clear></div><div class="title size-2">cell 1</div><div class="title size-2">cell 2</div><div class="title size-2">cell 3</div><div class="title size-2">cell 4</div><div class=clear></div><div class="gauge size-2"id=cell1ID></div><div class=h-split></div><div class="gauge size-2"id=cell2ID></div><div class=h-split></div><div class="gauge size-2"id=cell3ID></div><div class=h-split></div><div class="gauge size-2"id=cell4ID></div><div class=clear></div><div class="title size-2">cell 5</div><div class="title size-2">cell 6</div><div class="title size-2">cell 7</div><div class="title size-2">cell 8</div><div class=clear></div><div class="gauge size-2"id=cell5ID></div><div class=h-split></div><div class="gauge size-2"id=cell6ID></div><div class=h-split></div><div class="gauge size-2"id=cell7ID></div><div class=h-split></div><div class="gauge size-2"id=cell8ID></div><div class=clear></div><table><tr><td rowspan=2><div class=switch-title>charge</div><div class=toggle id=chargeStateID onclick=mosfetControl(this)><input name=chargeState type=checkbox></div><td rowspan=2><div class=switch-title>discharge</div><div class=toggle id=dischargeStateID onclick=mosfetControl(this)><input name=dischargeState type=checkbox></div><td rowspan=2><div class=switch-title>BLE</div><div class=toggle id=BLEStateID onclick=disconnectBLE(this)><input name=BLEState type=checkbox></div><td style="border-right:none; width:60px"><div class=switch-title>C1</div><td style=border-left:none;><div class=toggle id=cellBalanceID0><input name=cellBalance type=checkbox></div><td style="border-right:none; width:60px"><div class=switch-title>C2</div><td style=border-left:none;><div class=toggle id=cellBalanceID1><input name=cellBalance type=checkbox></div><td style="border-right:none; width:60px"><div class=switch-title>C3</div><td style=border-left:none;><div class=toggle id=cellBalanceID2><input name=cellBalance type=checkbox></div><td style="border-right:none; width:60px"><div class=switch-title>C4</div><td style=border-left:none;><div class=toggle id=cellBalanceID3><input name=cellBalance type=checkbox></div><tr><td style="border-right:none; width:60px"><div class=switch-title>C5</div><td style=border-left:none;><div class=toggle id=cellBalanceID4><input name=cellBalance type=checkbox></div><td style="border-right:none; width:60px"><div class=switch-title>C6</div><td style=border-left:none;><div class=toggle id=cellBalanceID5><input name=cellBalance type=checkbox></div><td style="border-right:none; width:60px"><div class=switch-title>C7</div><td style=border-left:none;><div class=toggle id=cellBalanceID6><input name=cellBalance type=checkbox></div><td style="border-right:none; width:60px"><div class=switch-title>C8</div><td style=border-left:none;><div class=toggle id=cellBalanceID7><input name=cellBalance type=checkbox></div></table><table><td rowspan=2><div class="row gx-0 mb-2 bg-light rounded bg-opacity-50 px-2"><div class=col>charge</div><div class="col dF"><div class="form-check form-switch"><input class=form-check-input id=chargeStateID role=switch type=checkbox></div></div></div><td><div class="row gx-0 mb-2 bg-light rounded bg-opacity-50 px-2"><div class=col>discharge</div><div class="col dF"><div class="form-check form-switch"><input class=form-check-input id=dischargeStateID role=switch type=checkbox></div></div></div><td><div class="row gx-0 mb-2 bg-light rounded bg-opacity-50 px-2"><div class=col>BMS</div><div class="col dF"><div class="form-check form-switch"><input class=form-check-input id=bmsStateID role=switch type=checkbox></div></div></div></table><div class="d-grid gap-2"><a class="btn btn-primary"href=/ role=button>back</a></div><script>var disconnectBLE=(a=>{fetch(`/disconnectBLE`).then(a=>{console.log(`disconnectBLE`)}).catch(a=>{console.error(`Error:`,a)})});var onMessage=(a=>{let c=`? `,d=`V `,e=`°C `;var b=JSON.parse(a.data);document.getElementById(`deviceNameID`).innerHTML=b.BAT.name;document.getElementById(`deviceAliasID`).innerHTML=`Jbd`+ b.BAT.alias;document.getElementById(`stateID`).innerHTML=b.BAT.state;document.getElementById(`voltageID`).innerHTML=b.BAT.voltage+ `V  `;document.getElementById(`currentID`).innerHTML=b.BAT.current+ `A  `;document.getElementById(`powerID`).innerHTML=Math.round(b.BAT.power)+ `W  `;document.getElementById(`SoCID`).innerHTML=b.BAT.soc+ `%%`;$(`#SoCID`).width(b.BAT.soc+ `%`).attr(`aria-valuenow`,b.BAT.soc);document.getElementById(`remainingID`).innerHTML=b.BAT.soc_Ah+ `Ah `;document.getElementById(`cellHID`).innerHTML=b.CELLS.imax+ c+ b.CELLS.max+ d;document.getElementById(`cellLID`).innerHTML=b.CELLS.imin+ c+ b.CELLS.min+ d;document.getElementById(`cyclesID`).innerHTML=b.BAT.cycles+ ` `;document.getElementById(`temp1ID`).innerHTML=b.TEMP.temp1+ e;document.getElementById(`temp2ID`).innerHTML=b.TEMP.temp2+ e;document.getElementById(`temp3ID`).innerHTML=b.TEMP.temp3+ e;document.getElementById(`cellDiffID`).innerHTML=b.CELLS.diff+ d;document.getElementById(`chargeStateID`).checked=b.BAT.charging;document.getElementById(`dischargeStateID`).checked=b.BAT.discharging;document.getElementById(`cellBalanceActiveID`).checked=b.BAT.balance;document.getElementById(`relayActiveID`).checked=b.REL.active});var BMSSwitch=(()=>{let a;if(document.getElementById(`bmsStateID`).checked){a=`bms_on`}else{a=`bms_off`};websocket.send(a)});var ChargeSwitch=(()=>{let a;if(document.getElementById(`chargeStateID`).checked){a=`charge_on`}else{a=`charge_off`};websocket.send(a)});var initWebSocket=(()=>{console.log(`trying to open a WebSocket connection...`);websocket=new WebSocket(gateway);websocket.onopen=onOpen;websocket.onclose=onClose;websocket.onerror=onError;websocket.onmessage=onMessage});var onOpen=(a=>{console.log(`Connection opened`);setInterval(checkWS,5000)});var toggleSwitch=((a,b)=>{let c=`checked`;switch(b){case 3:if(a.classList.contains(c))a.classList.remove(c);else a.classList.add(c);break;case 1:if(!a.classList.contains(c))a.classList.add(c);break;case 0:if(a.classList.contains(c))a.classList.remove(c);break}});var DischargeSwitch=(()=>{let a;if(document.getElementById(`dischargeStateID`).checked){a=`discharge_on`}else{a=`discharge_off`};websocket.send(a)});var onError=(a=>{document.getElementById(`stateID`).innerHTML=`WS lost`;console.log(`Connection lost`)});var onClose=(a=>{document.getElementById(`stateID`).innerHTML=`WS closed`;console.log(`Connection closed`);setTimeout(initWebSocket,3000)});var mosfetControl=(a=>{let b=1,c=JSON.stringify;if(a.id==`chargeStateID`)bmsState.mosfetState.chargeState^=b;else bmsState.mosfetState.dischargeState^=b;$.ajax({type:`POST`,url:`/mosfetCtrl`,data:c(bmsState.mosfetState),contentType:`application/json`,dataType:`json`,success:(a=>{console.log(`mosfetControl sucseeded:`+ c(a))}),error:(a=>{alert(a.response)})})});var initButton=(()=>{let a=`click`;document.getElementById(`chargeStateID`).addEventListener(a,ChargeSwitch);document.getElementById(`dischargeStateID`).addEventListener(a,DischargeSwitch);document.getElementById(`bmsStateID`).addEventListener(a,BMSSwitch)});$(document).ready((()=>{initWebSocket();initButton();setInterval(refreshAlert,5000)}));var bmsState;document.addEventListener(`DOMContentLoaded`,(a=>{let y=5,F=0,x=3,u=0.6,B=`V`,z=2,D=1,I=0.02,A=40,w=10,C=50,G=4,E=` C`,H=3.5,J=1000,K=6,L=7,M=`valueFontColor`,v=14;var t=(()=>{fetch(`/lifeJson`).then(a=>a.json()).then(a=>{bmsState=a;var q=a.current/J;if(q>=F){m.refresh(q,A,F)}else{m.refresh(q,F,-A)};n.refresh(a.soc);o.refresh(a.temp1/w);p.refresh(a.temp2/w);l.refresh(a.voltage/J);b.refresh(a.cellVoltages[F]/J);c.refresh(a.cellVoltages[D]/J);d.refresh(a.cellVoltages[z]/J);e.refresh(a.cellVoltages[x]/J);f.refresh(a.cellVoltages[G]/J);g.refresh(a.cellVoltages[y]/J);h.refresh(a.cellVoltages[K]/J);j.refresh(a.cellVoltages[L]/J);k.refresh(a.cellDiff/J);b.update(M,s(a.cellVoltages[F],a.cellMedian));c.update(M,s(a.cellVoltages[D],a.cellMedian));d.update(M,s(a.cellVoltages[z],a.cellMedian));e.update(M,s(a.cellVoltages[x],a.cellMedian));f.update(M,s(a.cellVoltages[G],a.cellMedian));g.update(M,s(a.cellVoltages[y],a.cellMedian));h.update(M,s(a.cellVoltages[K],a.cellMedian));j.update(M,s(a.cellVoltages[L],a.cellMedian));toggleSwitch(document.getElementById(`chargeStateID`),a.mosfet.charge);toggleSwitch(document.getElementById(`dischargeStateID`),a.mosfet.discharge);toggleSwitch(document.getElementById(`BLEStateID`),a.connected);for(i=F;i<8;i++){toggleSwitch(document.getElementById(`cellBalanceID`+ i),a.cellBalances[i])}})});var s=((a,b)=>{var c=a- b;if(c>I)return `#FF0000`;if(c<-I)return `#FFFF00`;return `#000000`});var b,c,d,e,f,g,h,j,k,l,m,n,o,p;var q={gaugeWidthScale:u,minLabelMinFontSize:v,maxLabelMinFontSize:v,pointer:!0,pointerOptions:{toplength:w,bottomlength:w,bottomwidth:x},valueMinFontSize:26,counter:!0,relativeGaugeSize:!0};var r={gaugeWidthScale:u,pointer:!0,pointerOptions:{toplength:y,bottomlength:15,bottomwidth:z},counter:!0,donut:!0,relativeGaugeSize:!0};m=new JustGage({id:`currentID`,defaults:q,min:-A,max:A,decimals:z,symbol:`A`});l=new JustGage({id:`voltageID`,defaults:q,max:30,min:20,value:25,decimals:z,symbol:B});o=new JustGage({id:`temp1ID`,defaults:q,max:C,decimals:D,symbol:E});p=new JustGage({id:`temp2ID`,defaults:q,max:C,decimals:D,symbol:E});n=new JustGage({id:`socID`,defaults:q,max:100,decimals:F,symbol:`%`});b=new JustGage({id:`cell1ID`,defaults:q,max:G,value:H,decimals:x,symbol:B});c=new JustGage({id:`cell2ID`,defaults:q,max:G,value:H,decimals:x,symbol:B});d=new JustGage({id:`cell3ID`,defaults:q,max:G,value:H,decimals:x,symbol:B});e=new JustGage({id:`cell4ID`,defaults:q,max:G,value:H,decimals:x,symbol:B});f=new JustGage({id:`cell5ID`,defaults:q,max:G,value:H,decimals:x,symbol:B});g=new JustGage({id:`cell6ID`,defaults:q,max:G,value:H,decimals:x,symbol:B});h=new JustGage({id:`cell7ID`,defaults:q,label:`Cell-7`,max:G,value:H,decimals:x,symbol:B});j=new JustGage({id:`cell8ID`,defaults:q,label:`Cell-8`,max:G,value:H,decimals:x,symbol:B});k=new JustGage({id:`cellDiffID`,defaults:q,max:0.3,decimals:x,symbol:B});setInterval(()=>{t()},J)}))</script>)rawliteral";
#define life_LENGTH 12962
static const char logout[] PROGMEM = R"rawliteral(%header% <figure class=text-center><h3>Logout from %deviceName%</h3></figure><div class="d-grid gap-2"><a class="btn btn-primary"href=/ role=button>Login</a></div> %footer% <p hidden>)rawliteral";
#define logout_LENGTH 183
static const char reboot[] PROGMEM = R"rawliteral(%header% <figure class=text-center><h3>rebooting</h3><h4 id=wait>.</h4></figure><div class="d-grid gap-2"><a class="btn btn-primary"href=/ role=button>Main</a></div><script>$(document).ready((()=>{let e=`/`,d=`.`;var b=(()=>{setInterval(c,1000)});var c=(()=>{$.get(e).done((()=>{window.location=e;console.log(`success`)})).fail((()=>{console.log(`failed.`)}))});window.dotsGoingUp=!0;var a=window.setInterval((()=>{var a=document.getElementById(`wait`);if(window.dotsGoingUp)a.innerHTML+=d;else{a.innerHTML=a.innerHTML.substring(1,a.innerHTML.length);if(a.innerHTML===d)window.dotsGoingUp=!0};if(a.innerHTML.length>9)window.dotsGoingUp=!1}),100);setTimeout(b,2000)}))</script> %footer% <p hidden>)rawliteral";
#define reboot_LENGTH 696
static const char settings[] PROGMEM = R"rawliteral(%header% <figure class=text-center><h2>Settings</h2></figure><div class="d-grid gap-2"><a class="btn btn-primary"href=/settingsedit role=button>Configuration</a></div><div class="row gx-0 mb-0 bg-light bg-opacity-50 px-0"><div class="input-group mb-0"><span class="input-group-text w-100"><b>SPIFFS</b></span><span class="input-group-text w-100">Build Time Stamp: %timestamp%</span><span class="input-group-text w-100">SPIFFS Storage: <span id=totalspiffsID> %total%</span> | used: <span id=usedspiffsID> %used%</span></span></div></div><div class="d-grid gap-2"><a class="btn btn-primary"onclick=Directory() role=button>Directory</a><a class="btn btn-primary"onclick=Upload() role=button>Upload</a><form id=uploadFormID><div class="input-group mb-0"><input accept=.bin aria-describedby=uploadformfield aria-label=Upload class=form-control id=uploadformfield name=update type=file><input class="btn btn-primary"value="Firmware Update"id=uploadButtonID onclick=postFile() type=button></div></form><div class="row gx-0 mb-1"id=uploadBarID style=display:none;><div class=col><div class=progress style=height:1.8rem;><div class="progress progress-bar"aria-valuemax=100 aria-valuemin=0 aria-valuenow=0 id=progress-bar-file1 role=progressbar style=width:0%%;height:1.8rem;></div></div></div></div><a class="btn btn-primary"href=/confirmreset role=button>Reset ESP</a><a class="btn btn-warning"href=/reboot role=button>Restart</a><a class="btn btn-primary"href=/webserial role=button style=%webserial% target=_blank>WebSerial</a><a class="btn btn-primary"onclick=Logout() role=button>Logout</a><a class="btn btn-primary"href=/ role=button>back</a></div><p id=statusID><p id=directoryHeaderID><p id=directoryDetailsID><p id=uploadHeaderID><p id=uploadID></p><script>var UploadFile=(()=>{let d=`file1`;var a=_(d).files[0];var b=new FormData();b.append(d,a);var c=new XMLHttpRequest();c.upload.addEventListener(`progress`,ProgressHandler,!1);c.addEventListener(`load`,CompleteHandler,!1);c.addEventListener(`error`,ErrorHandler,!1);c.addEventListener(`abort`,AbortHandler,!1);c.open(`POST`,`/`);c.send(b)});var Upload=(()=>{document.getElementById(`uploadHeaderID`).innerHTML=`<h5>upload File<h5>`;document.getElementById(`statusID`).innerHTML=``;var a=`<form id=\\"uploadFormID\\" enctype=\\"multipart/form-data\\" method=\\"post\\">`+ `<input type=\\"file\\" name=\\"file1\\" id=\\"file1\\" onchange=\\"UploadFile()\\"><br>`+ `<progress id=\\"progressBarID\\" value=\\"0\\" max=\\"100\\" style=\\"width:300px;\\"></progress>`+ `<h4 id=\\"statusID\\"></h4>`+ `<p id=\\"loaded_n_total\\"></p>`+ `</form>`;document.getElementById(`uploadID`).innerHTML=a});var Directory=(()=>{xmlhttp=new XMLHttpRequest();xmlhttp.open(`GET`,`/directory`,!1);xmlhttp.send();document.getElementById(`directoryHeaderID`).innerHTML=`<h5>Files<h5>`;document.getElementById(`directoryDetailsID`).innerHTML=xmlhttp.responseText});var postFile=(()=>{let d=0,f=100,g=`%%`,c=`#uploadformfield`,e=`#progress-bar-file1`;var a=new FormData();a.append(`uploadformfield`,$(c)[d].files[d]);var b=new XMLHttpRequest();b.onreadystatechange=(()=>{if(b.readyState==XMLHttpRequest.DONE){console.log(b.responseText);$(e).html(b.responseText);if(b.responseText==`OK`){window.location.href=`/reboot`}else{document.getElementById(`progress-bar-file1`).style.color=`red`}}});b.upload.addEventListener(`progress`,(a=>{var b=$(c)[d].files[d].size;document.getElementById(`uploadBarID`).style.display=``;if(a.loaded<=b){var h=Math.round(a.loaded/b*f);$(e).width(h+ g).html(h+ g)};if(a.loaded==a.total){$(e).width(f+ g).html(f+ g)}}));b.open(`post`,`/update`);b.timeout=45000;b.send(a)});var DirectoryButtonHandler=((a,b)=>{let d=`GET`,e=`statusID`;var c=`/file?name=`+ `/`+ a+ `&action=`+ b;xmlhttp=new XMLHttpRequest();if(b==`delete`){xmlhttp.open(d,c,!1);xmlhttp.send();document.getElementById(e).innerHTML=xmlhttp.responseText;xmlhttp.open(d,`/directory`,!1);xmlhttp.send();document.getElementById(`directoryDetailsID`).innerHTML=xmlhttp.responseText};if(b==`download`){document.getElementById(e).innerHTML=``;window.open(c,`_blank`)}});var Logout=(()=>{var a=new XMLHttpRequest();a.open(`GET`,`/logout`,!0);a.send();setTimeout((()=>{window.open(`/logged-out`,`_self`)}),1000)});var AbortHandler=(a=>{_(`statusID`).innerHTML=`aborted`});var ErrorHandler=(a=>{_(`statusID`).innerHTML=`Upload failed`});var Reboot=(()=>{let b=`/reboot`;document.getElementById(`statusID`).innerHTML=`invoking Reboot...`;var a=new XMLHttpRequest();a.open(`GET`,b,!0);a.send();setTimeout((()=>{window.open(b,`_self`)}),500)});var _=(a=>document.getElementById(a));var CompleteHandler=(a=>{let c=``,b=`statusID`;_(b).innerHTML=`Upload complete`;_(`progressBarID`).value=0;xmlhttp=new XMLHttpRequest();xmlhttp.open(`GET`,`/directory`,!1);xmlhttp.send();document.getElementById(b).innerHTML=`File uploaded`;document.getElementById(`directoryHeaderID`).innerHTML=`<h4>Files<h4>`;document.getElementById(`directoryDetailsID`).innerHTML=xmlhttp.responseText;document.getElementById(`uploadHeaderID`).innerHTML=c;document.getElementById(`uploadID`).innerHTML=c});var ProgressHandler=(a=>{let f=``,c=100,e=`statusID`,d=Math.round;_(`loaded_n_total`).innerHTML=`Uploaded `+ a.loaded+ ` bytes`;var b=(a.loaded/a.total)*c;_(`progressBarID`).value=d(b);_(e).innerHTML=d(b)+ `% uploaded... please wait`;if(b>=c){_(e).innerHTML=`done`;document.getElementById(`directoryHeaderID`).innerHTML=f;document.getElementById(`directoryDetailsID`).innerHTML=f;document.getElementById(`uploadHeaderID`).innerHTML=f;document.getElementById(`uploadID`).innerHTML=f}});var FlashSize=Number(`%flashSize%`);$(`#uploadformfield`).bind(`change`,function(){let b=`uploadButtonID`,a=0;console.log(this.files[a].size);console.log(FlashSize);if(this.files[a].size>FlashSize){document.getElementById(b).style.color=`red`;document.getElementById(b).value=`No Space`;document.getElementById(b).disabled=!0}else{document.getElementById(b).style.color=``;document.getElementById(b).value=`Update`;document.getElementById(b).disabled=!1}})</script> %footer% <p hidden>)rawliteral";
#define settings_LENGTH 6051
static const char settings_edit[] PROGMEM = R"rawliteral(%header% <figure class=text-center><h1>Edit Configuration</h1></figure><form action=/settingssave enctype=multipart/form-data method=POST><div class="input-group mb-0"><span class="input-group-text w-50"id=deviceNameDS>Device Name</span><input aria-describedby=deviceNameDS class=form-control id=devicename maxlength=20 name=_deviceName value=%deviceName%></div><div class="input-group mb-0"><span class="input-group-text w-50"id=mqttServerDS>MQTT Server</span><input aria-describedby=mqttServerDS class=form-control id=mqttServerID maxlength=20 name=_mqttServer value=%mqttServer%></div><div class="input-group mb-0"><span class="input-group-text w-50"id=mqttPortDS>MQTT Port</span><input aria-describedby=mqttPortDS class=form-control id=mqttPortID maxlength=5 name=_mqttPort value=%mqttPort%></div><div class="input-group mb-0"><span class="input-group-text w-50"id=mqttUserDS>MQTT User</span><input aria-describedby=mqttUserDS class=form-control id=mqttuserID maxlength=20 name=_mqttUser value=%mqttUser%></div><div class="input-group mb-0"><span class="input-group-text w-50"id=mqttPassDS>MQTT Password</span><input aria-describedby=mqttPassDS class=form-control id=mqttPassID maxlength=20 name=_mqttPass type=password value=%mqttPass%></div><div class="input-group mb-0"><span class="input-group-text w-50"id=mqttTopicDS>MQTT Topic</span><input aria-describedby=mqttTopicDS class=form-control id=mqttTopicID maxlength=20 name=_mqttTopic value=%mqttTopic%></div><div class="input-group mb-0"><span class="input-group-text w-50"id=mqttRefreshDS>MQTT Refresh (sec)</span><input aria-describedby=mqttRefreshDS class=form-control id=mqttRefreshID maxlength=5 name=_mqttRefresh value=%mqttRefresh%></div><div class="input-group mb-0"><span class="input-group-text w-50"id=mqttTriggerDS>MQTT Data Trigger</span><input aria-describedby=mqttTriggerDS class=form-control id=mqttTriggerID maxlength=80 name=_mqttTrigger value=%mqttTrigger%></div><div class="input-group mb-0"><span class="input-group-text w-50"id=mqttJsonDS>MQTT Json Style</span><div class="form-switch form-control mqtt-settings-switch"style="width:50%%; text-align: center;"><input class="form-check-input form control"%mqttjson% aria-describedby=mqttJsonDS id=mqttJsonID name=_mqttJson role=switch type=checkbox value=true></div></div><div class="input-group mb-0"><span class="input-group-text w-50"id=mqtthaDS>HA Discovery</span><div class="form-switch form-control mqtt-settings-switch"style="width:50%%; text-align: center;"><input class="form-check-input form control"%hadiscovery% aria-describedby=mqtthaDS id=haDiscoveryID name=_haDiscovery onclick=HASwitch() role=switch type=checkbox value=true></div></div><div class="input-group mb-0"><span class="input-group-text w-50"id=darkThemeDS>dark Theme</span><div class="form-switch form-control"style="width:50%%; text-align: center;"><input class="form-check-input form control"%darkmode% aria-describedby=darkThemeDS id=darkThemeID name=_darkMode role=switch type=checkbox value=true></div></div><div class="input-group mb-0"><span class="input-group-text w-50"id=httpPortDS>HTTP Port</span><input aria-describedby=httpPortDS class=form-control id=httpPortID maxlength=5 name=_httpPort value=%httpPort%></div><div class="input-group mb-0"><span class="input-group-text w-50"id=httpUserDS>HTTP Username</span><input aria-describedby=httpUserDS class=form-control id=httpUserID maxlength=20 name=_httpUser value=%httpUser%></div><div class="input-group mb-1"><span class="input-group-text w-50"id=httpPassDS>HTTP Password</span><input aria-describedby=httpPassDS class=form-control id=httpPassID maxlength=20 name=_httpPass type=password value=%httpPass%></div><div class="row gx-0 mb-0"id=esp01_settings style=%esp01%><div class="input-group mb-0"><span class="input-group-text w-100"><b>BMS Settings</b></span></div><div class="input-group mb-0"><span class="input-group-text w-50"id=bmsRefreshDS>BMS Refresh (sec)</span><input aria-describedby=bmsRefreshDS class=form-control id=bmsRefreshID maxlength=5 name=_bmsRefresh value=%bmsRefresh%></div><div class="input-group mb-1"><span class="input-group-text w-50"id=wakeupDS>enable BMS Wakeup GPIO%wakeupPin%</span><div class="form-switch form-control mqtt-settings-switch"style="width:50%%; text-align: center;"><input class="form-check-input form control"%wakeup% aria-describedby=wakeupDS id=wakeupenableID name=_wakeup role=switch type=checkbox value=true></div></div><div class="input-group mb-0"><span class="input-group-text w-100"><b>Output Settings</b></span></div><div class="input-group mb-0"><span class="input-group-text w-50"id=relayEnableDS>enable Output on GPIO%relayPin%</span><div class="form-switch form-control mqtt-settings-switch"style="width:50%%; text-align: center;"><input class="form-check-input form control"%relayenable% aria-describedby=relayEnableDS id=relayenableID name=_relayEnable onclick=RelaySwitch() role=switch type=checkbox value=true></div></div><div class="relayConfig input-group mb-0"><span class="input-group-text w-50"id=invertDS>invert GPIO Output</span><div class="form-switch form-control mqtt-settings-switch"style="width:50%%; text-align: center;"><input class="form-check-input form control"%relayinvert% aria-describedby=invertDS id=relayinvertID name=_relayInvert role=switch type=checkbox value=true></div></div><div class="relayConfig input-group mb-0"><span class="input-group-text w-50"id=failsafeDS>Failsafe Mode</span><div class="form-switch form-control mqtt-settings-switch"style="width:50%%; text-align: center;"><input class="form-check-input form control"%relayfailsave% aria-describedby=failsafeDS id=relayfailsafeID name=_relayFailsafe role=switch type=checkbox value=true></div></div><div class="relayConfig input-group mb-0"><span class="input-group-text w-50"id=functionDS>Function</span><select aria-describedby=functionDS class=form-select id=relayfunctionID name=_relayFunction onclick=RelayFunc()><option value=1>lowest SoC<option value=2>highest SoC<option value=3>lowest Cell Voltage<option value=4>highest Cell Voltage<option value=5>Pack Cell Voltage<option value=6>Temperature<option value=0>manual over Web or MQTT</select></div><div class="relayConfig relayData input-group mb-0"><span class="input-group-text w-50"id=comparsionDS>Comparsion</span><select aria-describedby=comparsionDS class=form-select id=relaycomparsionID name=_relayCompare><option value=0>higher or equal than<option value=1>lower or equal than</select></div><div class="relayConfig relayData input-group mb-0"><span class="input-group-text w-50"id=relaysetvalueDS>Value</span><input aria-describedby=relaysetvalueDS class=form-control id=relaysetvalue max=100 min=-100 name=_relayValue step=0.001 type=number value=%relayValue%></div><div class="relayConfig relayData input-group mb-2"><span class="input-group-text w-50"id=hysteresisDS>Hysteresis</span><input aria-describedby=hysteresisDS class=form-control id=relayHysteresisID max=100 min=-100 name=_relayHysteresis step=0.001 type=number value=%relayHysteresis%></div></div><div class="d-grid gap-2"><input class="btn btn-primary"value="save Settings"type=submit><a class="btn btn-primary"href=/settings role=button>back</a></div></form><script>var RelayFunc=(()=>{let c=0;var a=document.getElementsByClassName(`relayData`);for(var b=c;b<a.length;b++){if(document.getElementById(`relayfunctionID`).value==c||!document.getElementById(`relayenableID`).checked){a[b].style.display=`none`}else{a[b].style.display=``}}});var RelaySwitch=(()=>{var a=document.getElementsByClassName(`relayConfig`);for(var b=0;b<a.length;b++){if(document.getElementById(`relayenableID`).checked){a[b].style.display=``}else{a[b].style.display=`none`}}});var HASwitch=(()=>{let a=`haDiscoveryId`,b=`mqttJsonId`;if(document.getElementById(a).checked){document.getElementById(b).checked=!1;document.getElementById(b).disabled=!0};document.getElementById(b).disabled=document.getElementById(a).checked});$(document).ready((a=>{$(`#relayfunctionID`).val(`%relayFunction%`);$(`#relaycomparsionID`).val(`%relayComp%`);RelaySwitch();HASwitch();RelayFunc()}))</script> %footer% <p hidden>)rawliteral";
#define settings_edit_LENGTH 8134
static const char spiffs[] PROGMEM = R"rawliteral(%header% <figure class=text-center><h2>SPIFFS File Manager</h2></figure><div class="gx-0 bg-info bg-opacity-50 p-1 my-2"><figure class=text-center><h6>Build Time Stamp: %timestamp%</h6></figure><p><figure class=text-center><h6>SPIFFS Storage: <span id=totalspiffs>%total%</span> | used: <span id=usedspiffs>%used%</span></h6></figure></div><div class="d-grid gap-1"><a class="btn btn-primary"onclick=Directory() role=button>Directory</a><a class="btn btn-primary"onclick=Upload() role=button>upload</a><a class="btn btn-primary"onclick=Reboot() role=button>reboot</a><a class="btn btn-primary"onclick=Logout() role=button>logout</a><a class="btn btn-primary"href=/settings role=button>back</a></div><p id=statusID><p id=directoryHeaderID><p id=directoryDetailsID><p id=uploadHeaderID><p id=uploadID></p><script>var ProgressHandler=(a=>{let f=``,c=100,e=`statusID`,d=Math.round;_(`loaded_n_total`).innerHTML=`Uploaded `+ a.loaded+ ` bytes`;var b=(a.loaded/a.total)*c;_(`progressBarID`).value=d(b);_(e).innerHTML=d(b)+ `% uploaded... please wait`;if(b>=c){_(e).innerHTML=`done`;document.getElementById(`directoryHeaderID`).innerHTML=f;document.getElementById(`directoryDetailsID`).innerHTML=f;document.getElementById(`uploadHeaderID`).innerHTML=f;document.getElementById(`uploadID`).innerHTML=f}});var Upload=(()=>{document.getElementById(`uploadHeaderID`).innerHTML=`<h4>upload File<h4>`;document.getElementById(`statusID`).innerHTML=``;var a=`<form id=\\"uploadformID\\" enctype=\\"multipart/form-data\\" method=\\"post\\">`+ `<input type=\\"file\\" name=\\"file1\\" id=\\"file1\\" onchange=\\"UploadFile()\\"><br>`+ `<progress id=\\"progressBarID\\" value=\\"0\\" max=\\"100\\" style=\\"width:300px;\\"></progress>`+ `<h4 id=\\"statusID\\"></h4>`+ `<p id=\\"loaded_n_total\\"></p>`+ `</form>`;document.getElementById(`uploadID`).innerHTML=a});var UploadFile=(()=>{let d=`file1`;var a=_(d).files[0];var b=new FormData();b.append(d,a);var c=new XMLHttpRequest();c.upload.addEventListener(`progress`,ProgressHandler,!1);c.addEventListener(`load`,CompleteHandler,!1);c.addEventListener(`error`,ErrorHandler,!1);c.addEventListener(`abort`,AbortHandler,!1);c.open(`POST`,`/`);c.send(b)});var Directory=(()=>{xmlhttp=new XMLHttpRequest();xmlhttp.open(`GET`,`/directory`,!1);xmlhttp.send();document.getElementById(`directoryHeaderID`).innerHTML=`<h4>Files<h4>`;document.getElementById(`directoryDetailsID`).innerHTML=xmlhttp.responseText});var DirectoryButtonHandler=((a,b)=>{let d=`GET`,e=`statusID`;var c=`/file?name=`+ `/`+ a+ `&action=`+ b;xmlhttp=new XMLHttpRequest();if(b==`delete`){xmlhttp.open(d,c,!1);xmlhttp.send();document.getElementById(e).innerHTML=xmlhttp.responseText;xmlhttp.open(d,`/directory`,!1);xmlhttp.send();document.getElementById(`directoryDetailsID`).innerHTML=xmlhttp.responseText};if(b==`download`){document.getElementById(e).innerHTML=``;window.open(c,`_blank`)}});var Logout=(()=>{var a=new XMLHttpRequest();a.open(`GET`,`/logout`,!0);a.send();setTimeout((()=>{window.open(`/logged-out`,`_self`)}),1000)});var AbortHandler=(a=>{_(`statusID`).innerHTML=`aborted`});var _=(a=>document.getElementById(a));var Reboot=(()=>{let b=`/reboot`;document.getElementById(`statusID`).innerHTML=`invoking Reboot...`;var a=new XMLHttpRequest();a.open(`GET`,b,!0);a.send();setTimeout((()=>{window.open(b,`_self`)}),500)});var ErrorHandler=(a=>{_(`statusID`).innerHTML=`Upload failed`});var CompleteHandler=(a=>{let c=``,b=`statusID`;_(b).innerHTML=`Upload complete`;_(`progressBarID`).value=0;xmlhttp=new XMLHttpRequest();xmlhttp.open(`GET`,`/directory`,!1);xmlhttp.send();document.getElementById(b).innerHTML=`File uploaded`;document.getElementById(`directoryHeaderID`).innerHTML=`<h4>Files<h4>`;document.getElementById(`directoryDetailsID`).innerHTML=xmlhttp.responseText;document.getElementById(`uploadHeaderID`).innerHTML=c;document.getElementById(`uploadID`).innerHTML=c})</script>)rawliteral";
#define spiffs_LENGTH 3892
